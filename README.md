# TigerBot - æ™ºèƒ½å¾®ä¿¡èŠå¤©æœºå™¨äºº

<div align="center">

![Java](https://img.shields.io/badge/Java-17-orange)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.4.5-brightgreen)
![Spring AI](https://img.shields.io/badge/Spring%20AI-1.0.0-blue)
![Python](https://img.shields.io/badge/Python-3.8+-blue)
![License](https://img.shields.io/badge/License-MIT-green)

ä¸€ä¸ªåŸºäº **DDDæ¶æ„** å’Œ **Spring AI** çš„ä¼ä¸šçº§æ™ºèƒ½å¾®ä¿¡èŠå¤©æœºå™¨äººï¼Œæ”¯æŒæ¨¡å—åŒ–æ‰©å±•ã€æƒé™ç®¡ç†ã€AIè§’è‰²æ‰®æ¼”ç­‰åŠŸèƒ½ã€‚

</div>

## ğŸ“– é¡¹ç›®ç®€ä»‹

TigerBot æ˜¯ä¸€ä¸ªé‡‡ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)çš„ä¼ä¸šçº§å¾®ä¿¡èŠå¤©æœºå™¨äººï¼Œå…·å¤‡å®Œæ•´çš„æ¨¡å—åŒ–æ¶æ„ï¼š

- **ğŸ›ï¸ DDDæ¶æ„**ï¼šé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼Œæ¸…æ™°çš„åˆ†å±‚æ¶æ„å’Œæ¨¡å—è¾¹ç•Œ
- **ğŸ§  æ™ºèƒ½æ ¸å¿ƒ**ï¼šåŸºäº Spring AI æ¡†æ¶çš„å¤šAIæä¾›å•†æ”¯æŒ
- **ğŸ”— å¾®ä¿¡é›†æˆ**ï¼šPython wxauto + WebSocket å®ç°çš„ç¨³å®šå¾®ä¿¡é€šä¿¡
- **ğŸ­ è§’è‰²ç³»ç»Ÿ**ï¼šå¯é…ç½®çš„AIè§’è‰²å’Œæç¤ºè¯ç®¡ç†
- **ğŸ” æƒé™æ§åˆ¶**ï¼šç»†ç²’åº¦çš„å‘½ä»¤æƒé™ç®¡ç†ç³»ç»Ÿ
- **ğŸ“Š ç®¡ç†åå°**ï¼šWebç®¡ç†ç•Œé¢ï¼Œæ”¯æŒé…ç½®å’Œç›‘æ§

### æ ¸å¿ƒç‰¹æ€§

- âœ¨ **æ¨¡å—åŒ–æ¶æ„**ï¼štiger-bot-core(æ ¸å¿ƒ) + tiger-bot-management(ç®¡ç†)
- ğŸ­ **AIè§’è‰²ç®¡ç†**ï¼šæ•°æ®åº“é…ç½®AIæä¾›å•†ã€æ¨¡å‹å’Œè§’è‰²
- ğŸ” **æƒé™ç³»ç»Ÿ**ï¼šåŸºäºèŠå¤©å¯¹è±¡ã€å‘½ä»¤ã€ç”¨æˆ·çš„ä¸‰çº§æƒé™æ§åˆ¶
- ğŸ“Š **æ™ºèƒ½æ€»ç»“**ï¼šAIåˆ†æç¾¤èŠè®°å½•å¹¶ç”Ÿæˆå›¾ç‰‡æ‘˜è¦
- ğŸ”„ **æ¶ˆæ¯å¤„ç†é“¾**ï¼šè´£ä»»é“¾æ¨¡å¼ï¼Œæ”¯æŒè‡ªå®šä¹‰å¤„ç†å™¨æ‰©å±•
- ğŸ“ **æ–‡ä»¶å¤„ç†**ï¼šæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼çš„å‘é€å’Œæ¥æ”¶
- ğŸŒ **Webç®¡ç†**ï¼šå®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€å’Œé…ç½®ç®¡ç†

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TigerBot ç³»ç»Ÿæ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  Management     â”‚    â”‚   Core Module   â”‚                 â”‚
â”‚  â”‚   Module        â”‚    â”‚                 â”‚                 â”‚
â”‚  â”‚  (Webç®¡ç†ç•Œé¢)   â”‚    â”‚  (æ ¸å¿ƒä¸šåŠ¡é€»è¾‘)  â”‚                 â”‚
â”‚  â”‚   :8080         â”‚    â”‚    :8080        â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚           â”‚                       â”‚                         â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                       â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              å…±äº«åŸºç¡€è®¾æ–½å±‚                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚ PostgreSQL  â”‚  â”‚   Spring    â”‚  â”‚   Python    â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  Database   â”‚  â”‚     AI      â”‚  â”‚   Gateway   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚   :8000     â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    å¾®ä¿¡PCå®¢æˆ·ç«¯      â”‚
                    â”‚     (wxauto)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—è¯´æ˜

- **tiger-bot-core**: æ ¸å¿ƒä¸šåŠ¡æ¨¡å—ï¼Œå®ç°DDDæ¶æ„çš„æ¶ˆæ¯å¤„ç†å’ŒAIå¯¹è¯
- **tiger-bot-management**: ç®¡ç†æ¨¡å—ï¼Œæä¾›Webç•Œé¢è¿›è¡Œç³»ç»Ÿé…ç½®å’Œç›‘æ§
- **Python Gateway**: å¾®ä¿¡é€šä¿¡ç½‘å…³ï¼Œå¤„ç†å¾®ä¿¡æ¶ˆæ¯çš„æ”¶å‘
- **PostgreSQL**: æ•°æ®æŒä¹…åŒ–ï¼Œå­˜å‚¨é…ç½®ã€æƒé™ã€èŠå¤©è®°å½•ç­‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Java**: JDK 17+
- **Python**: 3.8+
- **æ•°æ®åº“**: PostgreSQL 12+
- **å¾®ä¿¡**: PC ç‰ˆå¾®ä¿¡å®¢æˆ·ç«¯
- **API**: DeepSeek API Key

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-username/tiger-bot.git
cd tiger-bot
```

### 2. åˆ›å»ºæ•°æ®åº“

åˆ›å»º PostgreSQL æ•°æ®åº“ï¼š

```sql
CREATE DATABASE tigerbot;
```

### 3. é…ç½®åº”ç”¨

ç¼–è¾‘ `tiger-bot-core/src/main/resources/application.yml`ï¼š

```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/tigerbot
    username: your_username
    password: your_password
    driver-class-name: org.postgresql.Driver
  sql:
    init:
      mode: always  # é¦–æ¬¡å¯åŠ¨è®¾ç½®ä¸ºalwaysï¼Œåç»­å¯æ”¹ä¸ºnever
      platform: postgresql
      schema-locations: classpath:scripts/schema-postgresql.sql
      data-locations: classpath:scripts/data.sql

chatbot:
  wx-auto-gateway-http-url: http://localhost:8000
  wx-auto-gateway-ws-url: ws://localhost:8765
```

**é‡è¦è¯´æ˜**ï¼š
- `sql.init.mode: always` ç”¨äºé¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„å’Œåˆå§‹åŒ–æ•°æ®
- é¦–æ¬¡å¯åŠ¨æˆåŠŸåï¼Œå»ºè®®æ”¹ä¸º `never` é¿å…é‡å¤åˆå§‹åŒ–
- ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºæ‰€æœ‰å¿…è¦çš„è¡¨å’Œåˆå§‹åŒ–ç¤ºä¾‹æ•°æ®

### 4. å®‰è£… Python ä¾èµ–

```bash
pip install -r requirements.txt
```

### 5. å¯åŠ¨æœåŠ¡

**æ–¹å¼ä¸€ï¼šåˆ†åˆ«å¯åŠ¨ï¼ˆæ¨èå¼€å‘ï¼‰**

å¯åŠ¨å¾®ä¿¡ç½‘å…³ï¼ˆç»ˆç«¯1ï¼‰ï¼š
```bash
cd wxauto
python wx_http_sse_gateway.py
```

å¯åŠ¨æ ¸å¿ƒæ¨¡å—ï¼ˆç»ˆç«¯2ï¼‰ï¼š
```bash
cd tiger-bot-core
mvn spring-boot:run
```

å¯åŠ¨ç®¡ç†æ¨¡å—ï¼ˆç»ˆç«¯3ï¼‰ï¼š
```bash
cd tiger-bot-management
mvn spring-boot:run
```

**æ–¹å¼äºŒï¼šDockerå¯åŠ¨ï¼ˆæ¨èç”Ÿäº§ï¼‰**

```bash
docker-compose up -d
```

### 6. é¦–æ¬¡å¯åŠ¨é…ç½®

**é‡è¦**ï¼šé¦–æ¬¡å¯åŠ¨å‰ç¡®ä¿é…ç½®æ­£ç¡®ï¼š

1. **æ•°æ®åº“åˆå§‹åŒ–**: ç¡®ä¿ `sql.init.mode: always` ç”¨äºè‡ªåŠ¨åˆ›å»ºè¡¨å’Œæ•°æ®
2. **APIå¯†é’¥é…ç½®**: åœ¨ `data.sql` ä¸­æ›´æ–°ä½ çš„DeepSeek APIå¯†é’¥ï¼š
   ```sql
   -- ä¿®æ”¹è¿™è¡Œä¸­çš„APIå¯†é’¥
   INSERT INTO "ai_providers" ("provider_type", "provider_name", "api_key", "base_url")
   VALUES ('deepseek', 'deepseek', 'sk-your-actual-api-key', 'https://api.deepseek.com/v1');
   ```

3. **å¯åŠ¨åä¿®æ”¹é…ç½®**: é¦–æ¬¡å¯åŠ¨æˆåŠŸåï¼Œå°† `sql.init.mode` æ”¹ä¸º `never`

### 7. è®¿é—®ç³»ç»Ÿ

- **å¾®ä¿¡æœºå™¨äºº**: ç¡®ä¿å¾®ä¿¡PCå®¢æˆ·ç«¯å·²ç™»å½•ï¼Œç½‘å…³ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶è¿æ¥
- **ç®¡ç†ç•Œé¢**: è®¿é—® http://localhost:8080 è¿›è¡Œç³»ç»Ÿé…ç½®å’Œç›‘æ§
- **æŸ¥çœ‹æ—¥å¿—**: è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºï¼Œç¡®è®¤æ•°æ®åº“åˆå§‹åŒ–å’Œå¾®ä¿¡è¿æ¥çŠ¶æ€

## ğŸ¯ åŠŸèƒ½ä½¿ç”¨

### åŸºç¡€èŠå¤©åŠŸèƒ½

- **æ™ºèƒ½å¯¹è¯**ï¼šæ”¯æŒå¤šAIæä¾›å•†ï¼ˆDeepSeekã€OpenAIç­‰ï¼‰
- **è§’è‰²æ‰®æ¼”**ï¼šé€šè¿‡ç®¡ç†ç•Œé¢é…ç½®AIè§’è‰²å’Œæç¤ºè¯
- **ä¸Šä¸‹æ–‡è®°å¿†**ï¼šè‡ªåŠ¨è®°å½•å¯¹è¯å†å²ï¼Œæ”¯æŒè¿ç»­å¯¹è¯
- **ç¾¤èŠ@å›å¤**ï¼šæ”¯æŒç¾¤èŠä¸­@æœºå™¨äººè¿›è¡Œå¯¹è¯

### å‘½ä»¤ç³»ç»Ÿ

| å‘½ä»¤ | åŠŸèƒ½ | æƒé™è¦æ±‚ | ç¤ºä¾‹ |
|------|------|----------|------|
| `/help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | æ—  | æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤ |
| `/status` | æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€ | ç®¡ç†å‘˜ | æ˜¾ç¤ºè¿è¡ŒçŠ¶æ€å’Œé…ç½® |
| `/æ€»ç»“ [æ—¥æœŸ] [ç¾¤å]` | AIæ€»ç»“èŠå¤©è®°å½• | é…ç½®æƒé™ | `/æ€»ç»“ ä»Šå¤© å·¥ä½œç¾¤` |
| `/addListener [ç¾¤å]` | æ·»åŠ ç›‘å¬ç¾¤èŠ | ç®¡ç†å‘˜ | `/addListener æ–°ç¾¤èŠ` |

### æƒé™ç®¡ç†

ç³»ç»Ÿæ”¯æŒä¸‰çº§æƒé™æ§åˆ¶ï¼š
- **èŠå¤©å¯¹è±¡çº§åˆ«**ï¼šå“ªäº›ç¾¤èŠ/ç§èŠå¯ä»¥ä½¿ç”¨æœºå™¨äºº
- **å‘½ä»¤çº§åˆ«**ï¼šå“ªäº›å‘½ä»¤å¯ä»¥åœ¨ç‰¹å®šèŠå¤©ä¸­ä½¿ç”¨
- **ç”¨æˆ·çº§åˆ«**ï¼šå“ªäº›ç”¨æˆ·å¯ä»¥æ‰§è¡Œç‰¹å®šå‘½ä»¤

### Webç®¡ç†ç•Œé¢

è®¿é—® http://localhost:8080 å¯ä»¥ï¼š
- æŸ¥çœ‹ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
- ç®¡ç†AIæä¾›å•†å’Œæ¨¡å‹é…ç½®
- é…ç½®èŠå¤©ç›‘å¬å™¨
- è®¾ç½®å‘½ä»¤æƒé™
- æŸ¥çœ‹èŠå¤©è®°å½•å’Œç»Ÿè®¡

## âš™ï¸ é…ç½®ç®¡ç†

### æ•°æ®åº“è‡ªåŠ¨åˆå§‹åŒ–

ç³»ç»Ÿé‡‡ç”¨æ•°æ®åº“é…ç½®æ–¹å¼ï¼Œé¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ï¼š

1. **åˆ›å»ºè¡¨ç»“æ„**: è‡ªåŠ¨æ‰§è¡Œ `schema-postgresql.sql` åˆ›å»ºæ‰€æœ‰å¿…è¦çš„è¡¨
2. **åˆå§‹åŒ–æ•°æ®**: è‡ªåŠ¨æ‰§è¡Œ `data.sql` æ’å…¥ç¤ºä¾‹é…ç½®æ•°æ®
3. **AIé…ç½®**: é¢„ç½®DeepSeekæä¾›å•†ã€æ¨¡å‹å’Œå¤šä¸ªAIè§’è‰²
4. **ç¤ºä¾‹èŠå¤©**: åˆ›å»ºæµ‹è¯•ç¾¤èŠå’Œæƒé™é…ç½®

### é¢„ç½®AIè§’è‰²

ç³»ç»Ÿé¢„ç½®äº†å¤šä¸ªAIè§’è‰²ä¾›é€‰æ‹©ï¼š

| è§’è‰²åç§° | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|------|----------|
| æµ‹è¯•æœºå™¨äºº | ä¸“ä¸šã€ç®€æ´ã€é«˜æ•ˆ | æµ‹è¯•ç¯å¢ƒã€æ­£å¼å¯¹è¯ |
| è´´å§è€å“¥ | å¹½é»˜ã€çŠ€åˆ©ã€æƒ…ç»ªåŒ– | å¨±ä¹ç¾¤èŠã€æ´»è·ƒæ°”æ°› |
| è¿·ç³Šå°å­¦å¦¹ | å¯çˆ±ã€å¤©ç„¶å‘†ã€æ ¡å›­é£ | æ ¡å›­ç¾¤èŠã€è½»æ¾èŠå¤© |
| è´´å§è€å“¥-æ€»ç»“ | ä¸“ç”¨äºèŠå¤©æ€»ç»“ | `/æ€»ç»“` å‘½ä»¤ä¸“ç”¨ |

### ä¿®æ”¹AIé…ç½®

**æ–¹æ³•ä¸€ï¼šé€šè¿‡Webç®¡ç†ç•Œé¢**
1. è®¿é—® http://localhost:8080
2. åœ¨AIæä¾›å•†ç®¡ç†ä¸­ä¿®æ”¹APIå¯†é’¥
3. åœ¨AIæ¨¡å‹ç®¡ç†ä¸­è°ƒæ•´æ¨¡å‹å‚æ•°
4. åœ¨èŠå¤©é…ç½®ä¸­åˆ‡æ¢AIè§’è‰²

**æ–¹æ³•äºŒï¼šç›´æ¥ä¿®æ”¹æ•°æ®åº“**
```sql
-- æ›´æ–°DeepSeek APIå¯†é’¥
UPDATE ai_providers
SET api_key = 'sk-your-new-key'
WHERE provider_type = 'deepseek';

-- ä¸ºç‰¹å®šèŠå¤©åˆ‡æ¢AIè§’è‰²
UPDATE chats
SET ai_role_id = 2  -- åˆ‡æ¢åˆ°è´´å§è€å“¥è§’è‰²
WHERE name = 'ä½ çš„ç¾¤èŠåç§°';
```

### æ·»åŠ æ–°çš„èŠå¤©ç›‘å¬

```sql
-- æ·»åŠ æ–°çš„èŠå¤©å¯¹è±¡
INSERT INTO chats (name, group_flag, ai_provider_id, ai_model_id, ai_role_id)
VALUES ('æ–°ç¾¤èŠ', true, 1, 1, 2);

-- æ·»åŠ ç›‘å¬å™¨é…ç½®
INSERT INTO listeners (chat_id, at_reply_enable, save_pic, save_voice, parse_links)
VALUES (LASTVAL(), true, true, false, true);

-- æ·»åŠ å‘½ä»¤æƒé™ï¼ˆå¯é€‰ï¼‰
INSERT INTO chat_command_auths (chat_id, command_id, user_id)
VALUES (LASTVAL(), 1, 1);  -- ç»™ç”¨æˆ·IDä¸º1çš„ç”¨æˆ·åˆ†é…æ‰€æœ‰å‘½ä»¤æƒé™
```

## ğŸ”§ æ‰©å±•å¼€å‘

### é¡¹ç›®ç»“æ„ï¼ˆDDDæ¶æ„ï¼‰

```
tiger-bot/
â”œâ”€â”€ tiger-bot-core/                     # æ ¸å¿ƒä¸šåŠ¡æ¨¡å—
â”‚   â””â”€â”€ src/main/java/com/fffattiger/wechatbot/
â”‚       â”œâ”€â”€ domain/                      # é¢†åŸŸå±‚
â”‚       â”‚   â”œâ”€â”€ chat/                   # èŠå¤©èšåˆ
â”‚       â”‚   â”œâ”€â”€ command/                # å‘½ä»¤èšåˆ
â”‚       â”‚   â”œâ”€â”€ listener/               # ç›‘å¬å™¨èšåˆ
â”‚       â”‚   â”œâ”€â”€ user/                   # ç”¨æˆ·èšåˆ
â”‚       â”‚   â””â”€â”€ ai/                     # AIèšåˆ
â”‚       â”œâ”€â”€ application/                # åº”ç”¨å±‚
â”‚       â”‚   â””â”€â”€ service/                # åº”ç”¨æœåŠ¡
â”‚       â”œâ”€â”€ infrastructure/             # åŸºç¡€è®¾æ–½å±‚
â”‚       â”‚   â”œâ”€â”€ external/               # å¤–éƒ¨æœåŠ¡é›†æˆ
â”‚       â”‚   â””â”€â”€ ai/                     # AIé›†æˆ
â”‚       â””â”€â”€ interfaces/                 # æ¥å£å±‚
â”‚           â””â”€â”€ event/                  # äº‹ä»¶å¤„ç†
â”‚               â””â”€â”€ handlers/           # æ¶ˆæ¯å¤„ç†å™¨
â”œâ”€â”€ tiger-bot-management/               # ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ src/main/java/com/fffattiger/wechatbot/management/
â”‚       â”œâ”€â”€ controller/                 # Webæ§åˆ¶å™¨
â”‚       â””â”€â”€ service/                    # ç®¡ç†æœåŠ¡
â””â”€â”€ wxauto/                            # Pythonå¾®ä¿¡ç½‘å…³
    â””â”€â”€ wx_http_sse_gateway.py
```

### æ‰©å±•å¼€å‘æŒ‡å—

#### 1. æ·»åŠ è‡ªå®šä¹‰æ¶ˆæ¯å¤„ç†å™¨

åˆ›å»ºå¤„ç†å™¨ç±»å®ç° `MessageHandler` æ¥å£ï¼š

```java
@Service
public class CustomMessageHandler implements MessageHandler {

    @Override
    public boolean handle(MessageHandlerContext context, MessageHandlerChain chain) {
        // è‡ªå®šä¹‰å¤„ç†é€»è¾‘
        BatchedSanitizedWechatMessages.Chat.Message message = context.message();
        if (message.content().contains("ç‰¹æ®Šå…³é”®è¯")) {
            context.wx().sendText(context.currentChat().chat().name(), "æ£€æµ‹åˆ°ç‰¹æ®Šå…³é”®è¯");
            return false; // åœæ­¢å¤„ç†é“¾
        }
        return chain.handle(context); // ç»§ç»­å¤„ç†é“¾
    }

    @Override
    public int getOrder() {
        return 5; // å¤„ç†ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜
    }
}
```

#### 2. æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤å¤„ç†å™¨

ç»§æ‰¿ `AbstractCommandMessageHandler`ï¼š

```java
@Service
public class CustomCommandHandler extends AbstractCommandMessageHandler {

    @Override
    public boolean canHandle(String command) {
        return command.startsWith("/custom");
    }

    @Override
    public void doHandle(String command, String[] args, MessageHandlerContext context) {
        String chatName = context.currentChat().chat().name();
        context.wx().sendText(chatName, "æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤: " + command);
    }

    @Override
    public String description() {
        return "/custom [å‚æ•°] - è‡ªå®šä¹‰å‘½ä»¤è¯´æ˜";
    }
}
```

#### 3. æ·»åŠ æ–°çš„AIæä¾›å•†

1. åœ¨æ•°æ®åº“ä¸­æ·»åŠ AIæä¾›å•†é…ç½®ï¼š
```sql
INSERT INTO ai_providers (provider_type, provider_name, api_key, base_url)
VALUES ('openai', 'OpenAI', 'sk-your-key', 'https://api.openai.com');
```

2. æ·»åŠ å¯¹åº”çš„AIæ¨¡å‹é…ç½®ï¼š
```sql
INSERT INTO ai_models (ai_provider_id, model_name, description, max_tokens, temperature)
VALUES (1, 'gpt-4', 'GPT-4æ¨¡å‹', 4096, 0.7);
```

#### 4. è‡ªå®šä¹‰Webç®¡ç†åŠŸèƒ½

åœ¨ `tiger-bot-management` æ¨¡å—ä¸­æ·»åŠ æ–°çš„æ§åˆ¶å™¨ï¼š

```java
@RestController
@RequestMapping("/api/custom")
public class CustomManagementController {

    @GetMapping("/status")
    public ResponseEntity<String> getCustomStatus() {
        // è‡ªå®šä¹‰çŠ¶æ€æŸ¥è¯¢é€»è¾‘
        return ResponseEntity.ok("è‡ªå®šä¹‰çŠ¶æ€ä¿¡æ¯");
    }
}
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. å¾®ä¿¡ç½‘å…³è¿æ¥å¤±è´¥**
- æ£€æŸ¥å¾®ä¿¡ PC å®¢æˆ·ç«¯æ˜¯å¦å·²ç™»å½•
- ç¡®è®¤é˜²ç«å¢™è®¾ç½®å…è®¸ç›¸å…³ç«¯å£
- æ£€æŸ¥ Python ä¾èµ–æ˜¯å¦æ­£ç¡®å®‰è£…

**2. AI å›å¤å¼‚å¸¸**
- éªŒè¯ DeepSeek API Key æ˜¯å¦æœ‰æ•ˆ
- æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œ API é…é¢
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

**3. æ•°æ®åº“è¿æ¥é—®é¢˜**
- ç¡®è®¤ PostgreSQL æœåŠ¡æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®æ˜¯å¦æ­£ç¡®
- éªŒè¯æ•°æ®åº“ç”¨æˆ·æƒé™

**4. æ¶ˆæ¯å¤„ç†å»¶è¿Ÿ**
- è°ƒæ•´ `WECHAT_POLL_INTERVAL` å‚æ•°
- æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
- ä¼˜åŒ–æ¶ˆæ¯å¤„ç†å™¨é€»è¾‘

### æ—¥å¿—é…ç½®

åœ¨ `application.yml` ä¸­è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼š

```yaml
logging:
  level:
    '[com.fffattiger.wechatbot]': DEBUG  # åº”ç”¨æ—¥å¿—
    '[org.springframework.ai]': INFO     # Spring AI æ—¥å¿—
    '[root]': WARN                       # æ ¹æ—¥å¿—çº§åˆ«
```

## ğŸ“š APIå‚è€ƒ

### Pythonç½‘å…³API

è¯¦ç»†æ–‡æ¡£ï¼š[API_DOCUMENTATION_WX_GATEWAY.md](wxauto/API_DOCUMENTATION_WX_GATEWAY.md)

**ä¸»è¦ç«¯ç‚¹**:
- `POST /api/send_text_message` - å‘é€æ–‡æœ¬æ¶ˆæ¯
- `POST /api/send_file_by_upload` - ä¸Šä¼ å¹¶å‘é€æ–‡ä»¶
- `POST /api/add_listen_chat` - æ·»åŠ ç›‘å¬èŠå¤©
- `GET /api/get_robot_name` - è·å–æœºå™¨äººåç§°
- `WebSocket ws://localhost:8765` - å®æ—¶æ¶ˆæ¯æ¨é€

### ç®¡ç†API

**ç³»ç»Ÿç®¡ç†**:
- `GET /management/status` - ç³»ç»ŸçŠ¶æ€
- `POST /management/start-python` - å¯åŠ¨Pythonè¿›ç¨‹
- `POST /management/stop-python` - åœæ­¢Pythonè¿›ç¨‹

**é…ç½®ç®¡ç†**:
- `GET /config/listeners` - è·å–ç›‘å¬å™¨åˆ—è¡¨
- `POST /config/listeners` - åˆ›å»ºç›‘å¬å™¨
- `GET /config/commands` - è·å–å‘½ä»¤åˆ—è¡¨
- `POST /config/command-auth` - é…ç½®å‘½ä»¤æƒé™

### æŠ€æœ¯æ–‡æ¡£

å®Œæ•´çš„æŠ€æœ¯æ¶æ„æ–‡æ¡£ï¼š[TECHNICAL_DOCUMENTATION.md](TECHNICAL_DOCUMENTATION.md)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add amazing feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/amazing-feature`
5. æäº¤ Pull Request

## âš ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œå¾®ä¿¡ä½¿ç”¨æ¡æ¬¾ã€‚ä½¿ç”¨æœ¬é¡¹ç›®æ‰€äº§ç”Ÿçš„ä»»ä½•åæœç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š

- [wxauto](https://github.com/cluic/wxauto) - å¾®ä¿¡è‡ªåŠ¨åŒ–æ“ä½œåº“
- [Spring AI](https://github.com/spring-projects/spring-ai) - Spring ç”Ÿæ€ AI æ¡†æ¶
- [WeChatBot_WXAUTO_SE](https://github.com/iwyxdxl/WeChatBot_WXAUTO_SE) - å¾®ä¿¡æœºå™¨äººå‚è€ƒå®ç°
- [chatlog](https://github.com/sjzar/chatlog) - èŠå¤©è®°å½•å¤„ç†å·¥å…·

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼**

</div>